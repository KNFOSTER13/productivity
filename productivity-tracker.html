<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üíú</text></svg>">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, maximum-scale=3.0">
    <title>Kimberly's Productivity Tracker</title>
    
    <!-- Firebase Scripts -->
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
    
    <script>
        // Your Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDTd41vsTlzjKeGu7Eq91IM3Q-8v88h-ng",
            authDomain: "productivity-tracker-knf13.firebaseapp.com",
            projectId: "productivity-tracker-knf13",
            storageBucket: "productivity-tracker-knf13.firebasestorage.app",
            messagingSenderId: "76203539357",
            appId: "1:76203539357:web:7d474a6a57c631b80d96"
        };
        
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
    </script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Georgia', serif;
            line-height: 1.6;
            color: #333;
            background-color: #fefefe;
            padding: 10px;
            max-width: 100%;
            margin: 0;
            -webkit-text-size-adjust: 100%;
            touch-action: manipulation;
        }
        
        .header {
            text-align: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e8e8e8;
        }
        
        .header h1 {
            font-size: 1.8em;
            color: #2c3e50;
            margin-bottom: 8px;
        }
        
        .date {
            font-size: 1.1em;
            color: #7f8c8d;
            font-style: italic;
        }
        
        .container {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .section {
            background: #fff;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(255, 20, 147, 0.1);
            border-left: 5px solid #3498db;
            transition: all 0.3s ease;
            margin-bottom: 10px;
        }
        
        .section:hover {
            transform: translateY(-1px);
            box-shadow: 0 6px 20px rgba(255, 20, 147, 0.15);
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            user-select: none;
            -webkit-user-select: none;
            padding: 5px 0;
        }
        
        .section h2 {
            font-size: 1.3em;
            color: #2c3e50;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .collapse-icon {
            font-size: 1.2em;
            transition: transform 0.3s ease;
            color: #7f8c8d;
        }
        
        .section.collapsed .collapse-icon {
            transform: rotate(-90deg);
        }
        
        .section-content {
            overflow: hidden;
            transition: max-height 0.3s ease;
        }
        
        .section.collapsed .section-content {
            max-height: 0;
            padding-top: 0;
            margin-top: 0;
        }
        
        .section-description {
            color: #7f8c8d;
            font-size: 0.95em;
            margin-bottom: 15px;
            font-style: italic;
            line-height: 1.4;
        }
        
        .task-input {
            display: flex;
            margin-bottom: 15px;
            align-items: center;
            gap: 12px;
            padding: 8px 0;
        }
        
        .task-input input[type="checkbox"] {
            width: 22px;
            height: 22px;
            cursor: pointer;
            flex-shrink: 0;
        }
        
        .priority-buttons {
            display: flex;
            gap: 5px;
            margin-right: 10px;
        }
        
        .priority-btn {
            background: #f0f0f0;
            border: 1px solid #ddd;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.2s;
        }
        
        .priority-btn:hover {
            background: #e0e0e0;
            transform: translateY(-1px);
        }
        
        .priority-btn.active {
            background: #e8e8e8;
            border-color: #999;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .task-input input[type="text"] {
            flex: 1;
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-family: inherit;
            font-size: 1em;
            background: white;
            color: #333;
            min-height: 44px;
            box-sizing: border-box;
        }
        
        .task-input input[type="text"]:focus {
            outline: none;
            border-color: #FF1493;
            box-shadow: 0 0 0 3px rgba(255, 20, 147, 0.2);
            background: white;
        }
        
        /* Empire Integration Inputs */
        .empire-task-input {
            display: flex;
            margin-bottom: 15px;
            align-items: center;
            gap: 12px;
        }
        
        .empire-task-input input[type="checkbox"] {
            width: 22px;
            height: 22px;
            cursor: pointer;
            flex-shrink: 0;
        }
        
        .empire-task-input input[type="text"] {
            flex: 1;
            padding: 12px 15px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            font-family: inherit;
            font-size: 1em;
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            min-height: 44px;
            box-sizing: border-box;
        }
        
        .empire-task-input input[type="text"]:focus {
            outline: none;
            border-color: #fff;
            box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.3);
        }
        
        .add-task-btn {
            background: linear-gradient(45deg, #7B3F8A, #9A5FB8) !important;
            color: white !important;
            border: 2px solid rgba(255, 255, 255, 0.2) !important;
            padding: 12px 20px !important;
            border-radius: 8px !important;
            cursor: pointer !important;
            font-size: 1em !important;
            margin-top: 15px !important;
            transition: all 0.3s !important;
            box-shadow: 0 2px 8px rgba(123, 63, 138, 0.3) !important;
            width: 100% !important;
            min-height: 44px !important;
            font-weight: 600 !important;
            touch-action: manipulation !important;
        }
        
        .add-task-btn:hover,
        .add-task-btn:active {
            background: linear-gradient(45deg, #8E4BA0, #B070D0) !important;
            transform: translateY(-2px) !important;
            box-shadow: 0 4px 12px rgba(123, 63, 138, 0.4) !important;
        }
        
        .empire-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            margin-top: 15px;
            transition: all 0.3s;
            width: 100%;
            min-height: 44px;
            font-weight: 600;
        }
        
        .empire-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }
        
        .stats {
            position: sticky !important;
            top: 10px !important;
            right: 10px !important;
            background: linear-gradient(135deg, #6B2C91 0%, #9A4AC0 50%, #C084E8 100%) !important;
            color: white !important;
            padding: 12px 16px !important;
            border-radius: 12px !important;
            font-size: 0.9em !important;
            z-index: 1000 !important;
            box-shadow: 0 4px 15px rgba(107, 44, 145, 0.4) !important;
            margin-bottom: 15px !important;
            text-align: center !important;
            width: fit-content !important;
            margin-left: auto !important;
            margin-right: auto !important;
            border: 2px solid rgba(255, 255, 255, 0.2) !important;
        }
        
        .completed-count {
            font-weight: bold !important;
            font-size: 1.2em !important;
        }
        
        .sync-status {
            font-size: 0.8em !important;
            opacity: 0.95 !important;
            margin-top: 5px !important;
            text-align: center !important;
            background: rgba(255, 255, 255, 0.1) !important;
            padding: 4px 8px !important;
            border-radius: 8px !important;
            border: 1px solid rgba(255, 255, 255, 0.2) !important;
            color: white !important;
        }
        
        /* Yesterday's Review Styles */
        .yesterday-review {
            border-left-color: #6B2C91 !important;
            background: linear-gradient(135deg, #6B2C91 0%, #9A4AC0 50%, #C084E8 100%) !important;
            color: white !important;
            box-shadow: 0 4px 20px rgba(107, 44, 145, 0.4) !important;
            border: 2px solid rgba(255, 255, 255, 0.2) !important;
        }
        
        .yesterday-review h2 {
            color: white !important;
            text-align: center !important;
            font-size: 1.8em !important;
            margin-bottom: 15px !important;
        }
        
        .yesterday-review .section-description {
            color: rgba(255, 255, 255, 0.9) !important;
        }
        
        .yesterday-stats {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .stat-box {
            background: rgba(255, 255, 255, 0.2) !important;
            padding: 20px !important;
            border-radius: 10px !important;
            text-align: center !important;
            backdrop-filter: blur(10px) !important;
            border: 1px solid rgba(255, 255, 255, 0.3) !important;
            min-width: 120px !important;
        }
        
        .stat-number {
            font-size: 2.5em !important;
            font-weight: bold !important;
            color: white !important;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3) !important;
        }
        
        .stat-label {
            font-size: 0.9em !important;
            opacity: 0.9 !important;
            text-transform: uppercase !important;
            letter-spacing: 1px !important;
            margin-top: 5px !important;
            color: white !important;
        }
        
        .yesterday-tasks {
            background: rgba(255, 255, 255, 0.15) !important;
            padding: 20px !important;
            border-radius: 10px !important;
            margin: 20px 0 !important;
            backdrop-filter: blur(10px) !important;
            border: 1px solid rgba(255, 255, 255, 0.2) !important;
            max-height: 300px !important;
            overflow-y: auto !important;
        }
        
        .yesterday-task-item {
            background: rgba(255, 255, 255, 0.1) !important;
            padding: 12px 15px !important;
            margin: 8px 0 !important;
            border-radius: 8px !important;
            border-left: 4px solid rgba(255, 255, 255, 0.4) !important;
            display: flex !important;
            align-items: center !important;
            gap: 10px !important;
            color: white !important;
        }
        
        .task-category-badge {
            background: rgba(255, 255, 255, 0.3) !important;
            color: white !important;
            padding: 4px 8px !important;
            border-radius: 12px !important;
            font-size: 0.8em !important;
            font-weight: bold !important;
            text-transform: uppercase !important;
            letter-spacing: 0.5px !important;
        }
        
        .motivational-btn {
            background: rgba(255, 255, 255, 0.95) !important;
            color: #6B2C91 !important;
            border: 2px solid rgba(255, 255, 255, 0.4) !important;
            padding: 18px 30px !important;
            border-radius: 25px !important;
            cursor: pointer !important;
            font-size: 1.1em !important;
            font-weight: bold !important;
            margin: 20px auto !important;
            display: block !important;
            transition: all 0.3s !important;
            box-shadow: 0 4px 15px rgba(255, 255, 255, 0.3) !important;
            text-transform: uppercase !important;
            letter-spacing: 1px !important;
            min-height: 44px !important;
            touch-action: manipulation !important;
            width: 100% !important;
            max-width: 300px !important;
            backdrop-filter: blur(10px) !important;
        }
        
        .motivational-btn:hover,
        .motivational-btn:active {
            background: white !important;
            color: #6B2C91 !important;
            transform: translateY(-3px) !important;
            box-shadow: 0 6px 20px rgba(255, 255, 255, 0.5) !important;
            border-color: rgba(255, 255, 255, 0.6) !important;
        }
        /* Weekly Review Styles */
.weekly-review {
    border-left-color: #6B2C91 !important;
    background: linear-gradient(135deg, #6B2C91 0%, #9A4AC0 50%, #C084E8 100%) !important;
    color: white !important;
    box-shadow: 0 4px 20px rgba(107, 44, 145, 0.4) !important;
    border: 2px solid rgba(255, 255, 255, 0.2) !important;
}

.weekly-review h2 {
    color: white !important;
    text-align: center !important;
    font-size: 1.8em !important;
    margin-bottom: 15px !important;
}

.weekly-stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 20px;
    margin: 30px 0;
}

.weekly-breakdown {
    background: rgba(255, 255, 255, 0.15);
    padding: 20px;
    border-radius: 10px;
    margin: 20px 0;
    backdrop-filter: blur(10px);
}

.category-bar {
    margin: 15px 0;
}

.category-bar-label {
    display: flex;
    justify-content: space-between;
    margin-bottom: 8px;
    font-size: 0.9em;
}

.category-bar-fill {
    height: 25px;
    background: rgba(255, 255, 255, 0.3);
    border-radius: 12px;
    overflow: hidden;
    position: relative;
}

.category-bar-progress {
    height: 100%;
    background: linear-gradient(90deg, #FFD700, #FFA500);
    border-radius: 12px;
    display: flex;
    align-items: center;
    padding: 0 10px;
    font-size: 0.8em;
    font-weight: bold;
    transition: width 0.5s ease;
}

.weekly-insights {
    background: rgba(255, 255, 255, 0.1);
    padding: 20px;
    border-radius: 10px;
    margin: 20px 0;
    line-height: 1.8;
}

.insight-item {
    margin: 10px 0;
    padding-left: 20px;
    position: relative;
}

.insight-item:before {
    content: "üí°";
    position: absolute;
    left: 0;
}
        
        /* Empire Integration Points */
        .empire-integration {
            border-left-color: #B8860B !important;
            background: linear-gradient(135deg, #B8860B 0%, #DAA520 50%, #FFD700 100%) !important;
            color: white !important;
            box-shadow: 0 4px 20px rgba(184, 134, 11, 0.4) !important;
            border: 2px solid rgba(255, 255, 255, 0.3) !important;
        }
        
        .empire-integration h2 {
            color: white !important;
            text-align: center !important;
            font-size: 1.8em !important;
            margin-bottom: 15px !important;
        }
        
        .empire-integration .section-description {
            color: rgba(255, 255, 255, 0.9) !important;
            text-align: center !important;
        }
        
        .empire-subsection {
            margin-bottom: 25px;
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            backdrop-filter: blur(5px);
        }
        
        .empire-subsection h3 {
            color: white;
            margin-bottom: 15px;
            font-size: 1.2em;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        /* Creative Streaks */
        .creative-streaks {
            border-left-color: #6B2C91 !important;
            background: linear-gradient(135deg, #6B2C91 0%, #9A4AC0 50%, #C084E8 100%) !important;
            color: white !important;
            box-shadow: 0 4px 20px rgba(107, 44, 145, 0.4) !important;
            border: 2px solid rgba(255, 255, 255, 0.2) !important;
        }
        
        .creative-streaks h2 {
            color: white !important;
            text-align: center !important;
            font-size: 1.8em !important;
            margin-bottom: 10px !important;
        }
        
        .creative-streaks .section-description {
            color: rgba(255, 255, 255, 0.9) !important;
            text-align: center !important;
        }
        
        .streak-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 20px;
        }
        
        .streak-box {
            background: rgba(255, 255, 255, 0.15);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        .streak-number {
            font-size: 2.5em;
            font-weight: bold;
            color: white;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .streak-label {
            font-size: 0.9em;
            margin-top: 5px;
            color: white;
            opacity: 0.9;
        }
        
        .streak-emoji {
            font-size: 1.5em;
            margin-top: 10px;
        }
        
        /* Unstuck Suggestions Styles */
        .unstuck-suggestions {
            border-left-color: #6B2C91 !important;
            background: linear-gradient(135deg, #6B2C91 0%, #9A4AC0 50%, #C084E8 100%) !important;
            color: white !important;
            box-shadow: 0 4px 20px rgba(107, 44, 145, 0.4) !important;
            border: 2px solid rgba(255, 255, 255, 0.2) !important;
        }
        
        .unstuck-suggestions h2 {
            color: white !important;
        }
        
        .unstuck-suggestions .section-description {
            color: rgba(255, 255, 255, 0.9) !important;
        }
        
        .suggestion-controls {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .suggestion-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
            padding: 15px 20px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s;
            backdrop-filter: blur(10px);
            min-height: 44px;
            touch-action: manipulation;
            width: 100%;
        }
        
        .suggestion-btn:hover,
        .suggestion-btn:active {
            background: rgba(255, 255, 255, 0.3);
            border-color: rgba(255, 255, 255, 0.5);
            transform: translateY(-2px);
        }
        
        .suggestion-btn.primary {
            background: rgba(255, 255, 255, 0.95);
            color: #6B2C91;
            box-shadow: 0 2px 8px rgba(255, 255, 255, 0.3);
            border: 2px solid rgba(255, 255, 255, 0.4);
        }
        
        .suggestion-btn.primary:hover,
        .suggestion-btn.primary:active {
            background: white;
            color: #6B2C91;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255, 255, 255, 0.4);
        }
        
        #categoryFilter {
            padding: 15px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 1em;
            backdrop-filter: blur(10px);
            width: 100%;
            min-height: 44px;
            appearance: none;
            -webkit-appearance: none;
            background-image: url("data:image/svg+xml;charset=US-ASCII,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 4 5'><path fill='white' d='M2 0L0 2h4zm0 5L0 3h4z'/></svg>");
            background-repeat: no-repeat;
            background-position: right 15px center;
            background-size: 12px;
        }
        
        #categoryFilter option {
            background: #6B2C91;
            color: white;
        }
        
        .current-suggestion {
            background: rgba(255, 255, 255, 0.15);
            padding: 25px;
            border-radius: 10px;
            margin: 20px 0;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .suggestion-text {
            font-size: 1.1em;
            line-height: 1.6;
            margin-bottom: 10px;
            color: white;
        }
        
        .suggestion-category {
            font-size: 0.9em;
            opacity: 0.8;
            font-style: italic;
            color: white;
        }
        
        .suggestion-actions {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 15px;
        }
        
        .action-btn {
            background: linear-gradient(45deg, #9370DB, #DDA0DD);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s;
            box-shadow: 0 2px 8px rgba(147, 112, 219, 0.3);
            min-height: 44px;
            font-weight: 600;
            touch-action: manipulation;
            width: 100%;
        }
        
        .action-btn:hover,
        .action-btn:active {
            background: linear-gradient(45deg, #BA55D3, #E6E6FA);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(147, 112, 219, 0.4);
        }
        
        .action-btn.secondary {
            background: linear-gradient(45deg, #8A2BE2, #9370DB);
            border: 2px solid rgba(255, 255, 255, 0.4);
        }
        
        .action-btn.secondary:hover,
        .action-btn.secondary:active {
            background: linear-gradient(45deg, #9932CC, #BA55D3);
        }
        
        /* Creative workflow */
        .creative-workflow {
            background: linear-gradient(135deg, #E6E6FA 0%, #DDA0DD 50%, #9370DB 100%);
            color: white;
            border-left: none;
            box-shadow: 0 4px 20px rgba(221, 160, 221, 0.4);
            margin-bottom: 15px;
        }
        
        .creative-workflow h2 {
            color: white;
            font-size: 1.8em;
            text-align: center;
            margin-bottom: 30px;
        }
        
        .workflow-grid {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .workflow-section {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 8px;
            backdrop-filter: blur(10px);
        }
        
        .workflow-section h3 {
            font-size: 1.3em;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .workflow-section .examples {
            font-size: 0.9em;
            opacity: 0.8;
            margin-bottom: 15px;
            line-height: 1.4;
        }
        
        /* Goal Milestones */
        .goal-milestones {
            border-left-color: #6B2C91 !important;
            background: linear-gradient(135deg, #6B2C91 0%, #9A4AC0 50%, #C084E8 100%) !important;
            color: white !important;
            box-shadow: 0 4px 20px rgba(107, 44, 145, 0.4) !important;
            border: 2px solid rgba(255, 255, 255, 0.2) !important;
        }
        
        .goal-milestones h2 {
            color: white !important;
            text-align: center !important;
            font-size: 1.8em !important;
            margin-bottom: 10px !important;
        }
        
        .goal-milestones .section-description {
            color: rgba(255, 255, 255, 0.9) !important;
            text-align: center !important;
        }
        
        .goal-card {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .goal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .goal-title {
            font-size: 1.3em;
            font-weight: bold;
            color: white;
        }
        
        .goal-progress {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .progress-text {
            font-size: 0.9em;
            color: white;
            opacity: 0.9;
        }
        
        .progress-bar {
            width: 100%;
            height: 10px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 5px;
            overflow: hidden;
            margin-bottom: 15px;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #FFD700, #FFA500);
            transition: width 0.3s ease;
        }
        
        .milestone-list {
            list-style: none;
        }
        
        .milestone-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 0;
            color: white;
        }
        
        .milestone-checkbox {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }
        
        .milestone-text {
            flex: 1;
            font-size: 0.95em;
        }
        
        .milestone-item.completed .milestone-text {
            text-decoration: line-through;
            opacity: 0.7;
        }
        
        .add-milestone-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9em;
            margin-top: 10px;
            transition: all 0.3s;
        }
        
        .add-milestone-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }
        
        /* Brain dump */
        .brain-dump {
            background: linear-gradient(135deg, #6B2C91 0%, #9A4AC0 50%, #C084E8 100%) !important;
            border-left: 5px solid #6B2C91 !important;
            color: white !important;
            box-shadow: 0 4px 20px rgba(107, 44, 145, 0.4) !important;
            border: 2px solid rgba(255, 255, 255, 0.2) !important;
            border-left: 5px solid #6B2C91 !important;
        }
        
        .brain-dump h2 {
            color: white !important;
        }
        
        .brain-dump .section-description {
            color: rgba(255, 255, 255, 0.9) !important;
        }
        
        .brain-dump textarea {
            width: 100%;
            min-height: 120px;
            padding: 15px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            font-family: inherit;
            font-size: 1em;
            resize: vertical;
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            box-sizing: border-box;
        }
        
        .brain-dump textarea:focus {
            outline: none;
            border-color: #FF1493;
            box-shadow: 0 0 0 3px rgba(255, 20, 147, 0.2);
        }
        
        /* Daily Summary Styles */
        .daily-summary {
            background: linear-gradient(135deg, #6B2C91 0%, #9A4AC0 50%, #C084E8 100%) !important;
            border-left: 5px solid #6B2C91 !important;
            color: white !important;
            box-shadow: 0 4px 20px rgba(107, 44, 145, 0.4) !important;
            border: 2px solid rgba(255, 255, 255, 0.2) !important;
        }
        
        .daily-summary h2 {
            color: white !important;
        }
        
        .daily-summary .section-description {
            color: rgba(255, 255, 255, 0.9) !important;
        }
        
        .summary-controls {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .summary-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
            padding: 15px 20px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s;
            backdrop-filter: blur(10px);
            min-height: 44px;
            touch-action: manipulation;
            width: 100%;
        }
        
        .summary-btn:hover,
        .summary-btn:active {
            background: rgba(255, 255, 255, 0.3);
            border-color: rgba(255, 255, 255, 0.5);
            transform: translateY(-2px);
        }
        
        .summary-btn.primary {
            background: rgba(255, 255, 255, 0.95);
            color: #6B2C91;
            box-shadow: 0 2px 8px rgba(255, 255, 255, 0.3);
            border: 2px solid rgba(255, 255, 255, 0.4);
        }
        
        .summary-btn.primary:hover,
        .summary-btn.primary:active {
            background: white;
            color: #6B2C91;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255, 255, 255, 0.4);
        }
        
        .summary-content {
            background: rgba(255, 255, 255, 0.15);
            padding: 25px;
            border-radius: 10px;
            margin: 20px 0;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            line-height: 1.6;
        }
        
        .summary-placeholder {
            text-align: center;
            opacity: 0.8;
            font-style: italic;
        }
        
        .summary-section {
            margin-bottom: 25px;
        }
        
        .summary-section h3 {
            color: white;
            margin-bottom: 15px;
            font-size: 1.2em;
            border-bottom: 1px solid rgba(255, 255, 255, 0.3);
            padding-bottom: 8px;
        }
        
        .summary-stats {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .summary-stat {
            background: rgba(255, 255, 255, 0.2);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            flex: 1;
            min-width: 80px;
        }
        
        .summary-stat-number {
            font-size: 1.8em;
            font-weight: bold;
            color: white;
        }
        
        .summary-stat-label {
            font-size: 0.9em;
            opacity: 0.9;
            margin-top: 5px;
        }
        
        .summary-task-list {
            list-style: none;
            padding: 0;
        }
        
        .summary-task-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 10px 15px;
            margin: 8px 0;
            border-radius: 6px;
            border-left: 3px solid rgba(255, 255, 255, 0.4);
        }
        
        .summary-brain-dump {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 8px;
            margin-top: 10px;
            white-space: pre-wrap;
            font-style: italic;
        }
        
        /* Category-specific colors - Unicorn Palette */
        .work { border-left-color: #FF1493; } /* Hot Pink */
        .education { border-left-color: #FF6347; } /* Coral */
        .relationships { border-left-color: #FFD700; } /* Bright Gold */
        .money { border-left-color: #00FF7F; } /* Spring Green */
        .business { border-left-color: #32CD32; } /* Lime Green */
        .leisure { border-left-color: #00BFFF; } /* Deep Sky Blue */
        .vanity { border-left-color: #4169E1; } /* Royal Blue */
        .health { border-left-color: #DDA0DD; } /* Plum */
        .home { border-left-color: #9932CC; } /* Dark Orchid */
        
        /* Mobile-specific responsive adjustments */
        @media (max-width: 768px) {
            .yesterday-stats {
                flex-direction: column;
                gap: 15px;
            }
            
            .stat-box {
                min-width: auto;
                width: 100%;
                max-width: 200px;
                margin: 0 auto;
            }
            
            .workflow-section h3 {
                font-size: 1.2em;
            }
            
            .suggestion-controls {
                gap: 12px;
            }
            
            .streak-grid {
                grid-template-columns: 1fr;
            }
            
            .priority-buttons {
                flex-wrap: wrap;
            }
        }
        
        /* Larger mobile screens */
        @media (min-width: 769px) and (max-width: 1024px) {
            .container {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 20px;
                max-width: 800px;
                margin: 0 auto;
            }
            
            .creative-workflow,
            .brain-dump,
            .daily-summary,
            .goal-milestones {
                grid-column: 1 / -1;
            }
        }
        
        /* Desktop */
        @media (min-width: 1025px) {
            body {
                max-width: 1200px;
                margin: 0 auto;
                padding: 20px;
            }
            
            .container {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 30px;
            }
            
            .creative-workflow,
            .brain-dump,
            .daily-summary,
            .goal-milestones {
                grid-column: 1 / -1;
            }
            
            .stats {
                position: fixed;
                top: 20px;
                right: 20px;
                margin: 0;
            }
        }
        .time-tracking {
    display: flex;
    gap: 5px;
    align-items: center;
    margin-left: 10px;
}

.time-btn {
    background: #e8e8e8;
    border: 1px solid #ddd;
    padding: 4px 8px;
    border-radius: 4px;
    cursor: pointer;
    font-size: 0.85em;
    transition: all 0.2s;
}

.time-btn:hover {
    background: #d0d0d0;
}

.time-display {
    font-weight: bold;
    color: #6B2C91;
    margin-left: 8px;
    min-width: 60px;
}
    </style>
</head>
<body>
    <div class="stats">
        <div>Tasks Completed</div>
        <div class="completed-count" id="completedCount">0</div>
        <div class="sync-status" id="syncStatus">‚òÅ Cloud Loaded</div>
    </div>
    
   <div class="header">
    <h1>Daily Productivity Tracker</h1>
    <div class="date" id="currentDate"></div>
    <button onclick="startFreshDay()" style="margin-top: 10px; padding: 10px 20px; background: #6B2C91; color: white; border: none; border-radius: 8px; cursor: pointer;">üåÖ Start Fresh Day</button>  <button onclick="showWeeklyReview()" style="margin-top: 10px; margin-left: 10px; padding: 10px 20px; background: #9A4AC0; color: white; border: none; border-radius: 8px; cursor: pointer;">
    üìä Weekly Review
</button>
</div>
   
    
    <!-- Yesterday's Review Section -->
    <div class="section yesterday-review" id="yesterdaySection" style="display: none; margin-bottom: 30px;">
        <h2>üåü Yesterday's Wins</h2>
        <div class="section-description">Look at all the amazing things you accomplished yesterday!</div>
        <div class="yesterday-stats">
            <div class="stat-box">
                <div class="stat-number" id="yesterdayCount">0</div>
                <div class="stat-label">Tasks Completed</div>
            </div>
            <div class="stat-box">
                <div class="stat-number" id="streakCount">0</div>
                <div class="stat-label">Day Streak</div>
            </div>
        </div>
        <div class="yesterday-tasks" id="yesterdayTasks">
            <!-- Yesterday's completed tasks will appear here -->
        </div>
        <button class="motivational-btn" onclick="hideYesterdayReview()">Let's Build on This Success! üöÄ</button>
    </div>
    <!-- Weekly Review Section -->
<div class="section weekly-review" id="weeklySection" style="display: none; margin-bottom: 30px;">
    <h2>üìä Weekly Review</h2>
    <div class="section-description">Your productivity patterns over the past 7 days</div>
    
    <div class="weekly-stats-grid">
        <div class="stat-box">
            <div class="stat-number" id="weeklyTaskCount">0</div>
            <div class="stat-label">Tasks Completed</div>
        </div>
        <div class="stat-box">
            <div class="stat-number" id="weeklyTimeSpent">0h</div>
            <div class="stat-label">Time Invested</div>
        </div>
        <div class="stat-box">
            <div class="stat-number" id="mostProductiveDay">-</div>
            <div class="stat-label">Best Day</div>
        </div>
        <div class="stat-box">
            <div class="stat-number" id="topCategory">-</div>
            <div class="stat-label">Top Focus</div>
        </div>
    </div>
    
    <div class="weekly-breakdown" id="weeklyBreakdown">
        <!-- Category breakdown will go here -->
    </div>
    
    <div class="weekly-insights" id="weeklyInsights">
        <!-- Insights will go here -->
    </div>
    
    <button class="motivational-btn" onclick="hideWeeklyReview()">Ready for Another Productive Week! üí™</button>
</div>
    <!-- Empire Integration Points Section -->
    <div class="section empire-integration" style="margin-bottom: 30px;">
        <h2>‚ú® Empire Integration Points</h2>
        <div class="section-description">Strategic overview of your empire-building priorities</div>
        
        <div class="empire-subsection">
            <h3>üéØ Empire Priorities This Week</h3>
            <div id="empire-priorities"></div>
            <button class="empire-btn" onclick="addEmpireTask('empire-priorities')">+ Add Priority</button>
        </div>
        
        <div class="empire-subsection">
            <h3>üìÖ Major Business Deadlines</h3>
            <div id="empire-deadlines"></div>
            <button class="empire-btn" onclick="addEmpireTask('empire-deadlines')">+ Add Deadline</button>
        </div>
        
        <div class="empire-subsection">
            <h3>üí∞ Revenue-Critical Tasks</h3>
            <div id="empire-revenue"></div>
            <button class="empire-btn" onclick="addEmpireTask('empire-revenue')">+ Add Revenue Task</button>
        </div>
        
        <div class="empire-subsection">
            <h3>üîÑ Cross-Brand Opportunities</h3>
            <div id="empire-opportunities"></div>
            <button class="empire-btn" onclick="addEmpireTask('empire-opportunities')">+ Add Opportunity</button>
        </div>
    </div>
    
    <!-- Creative Streaks Section -->
    <div class="section creative-streaks" style="margin-bottom: 30px;">
        <h2>üî• Creative Streaks</h2>
        <div class="section-description">Build momentum with consistent creative habits</div>
        <div class="streak-grid">
            <div class="streak-box">
                <div class="streak-number" id="writingStreak">0</div>
                <div class="streak-label">Writing Streak</div>
                <div class="streak-emoji">‚úçÔ∏è</div>
            </div>
            <div class="streak-box">
                <div class="streak-number" id="submissionStreak">0</div>
                <div class="streak-label">Submission Streak</div>
                <div class="streak-emoji">üìÆ</div>
            </div>
            <div class="streak-box">
                <div class="streak-number" id="authorityStreak">0</div>
                <div class="streak-label">Authority Building</div>
                <div class="streak-emoji">üëë</div>
            </div>
            <div class="streak-box">
                <div class="streak-number" id="newsletterStreak">0</div>
                <div class="streak-label">Newsletter Consistency</div>
                <div class="streak-emoji">üì¨</div>
            </div>
        </div>
    </div>
    
    <!-- Unstuck Suggestions Section -->
    <div class="section unstuck-suggestions" style="margin-bottom: 30px;">
        <h2>‚ú® Feeling Stuck? Try This</h2>
        <div class="section-description">Goal-aligned suggestions to get you moving when motivation is low</div>
        
        <div class="suggestion-controls">
            <button class="suggestion-btn primary" onclick="getRandomSuggestion()">üé≤ Get Random Suggestion</button>
            <select id="categoryFilter" onchange="getSuggestionByCategory()">
                <option value="">Choose a focus area...</option>
                <option value="career">üìù Career & Creativity</option>
                <option value="wealth">üíº Wealth & Business</option>
                <option value="growth">üìö Growth & Learning</option>
                <option value="home">üè° Home & Environment</option>
                <option value="wellness">üå± Wellness & Health</option>
                <option value="vanity">‚ú® Vanity & Visibility</option>
                <option value="relationships">üíï Relationships & Community</option>
            </select>
        </div>
        
        <div class="current-suggestion" id="currentSuggestion">
            <div class="suggestion-text">Click "Get Random Suggestion" to start!</div>
        </div>
        
        <div class="suggestion-actions">
            <button class="action-btn" onclick="addSuggestionAsTask()">+ Add as Task</button>
            <button class="action-btn secondary" onclick="getAnotherSuggestion()">‚Üª Another Suggestion</button>
        </div>
    </div>
    
    <div class="container">
        <!-- Life Areas Grid -->
        <div class="section work">
            <h2>üíº Work</h2>
            <div class="section-description">Creative production, admin, and digital content</div>
            <div id="work-tasks"></div>
            <button class="add-task-btn" onclick="addTask('work')">+ Add Task</button>
        </div>
        
        <div class="section education">
            <h2>üìö Education</h2>
            <div class="section-description">Reading, researching, or watching intellectually nourishing media</div>
            <div id="education-tasks"></div>
            <button class="add-task-btn" onclick="addTask('education')">+ Add Task</button>
        </div>
        
        <div class="section relationships">
            <h2>üíù Relationships</h2>
            <div class="section-description">Connection, communication, and check-ins with your circle</div>
            <div id="relationships-tasks"></div>
            <button class="add-task-btn" onclick="addTask('relationships')">+ Add Task</button>
        </div>
        
        <div class="section money">
            <h2>üí∞ Money</h2>
            <div class="section-description">Tracking finances, pitching, promoting, or strategizing</div>
            <div id="money-tasks"></div>
            <button class="add-task-btn" onclick="addTask('money')">+ Add Task</button>
        </div>
        
        <div class="section business">
            <h2>üöÄ Business</h2>
            <div class="section-description">Growth, audience engagement, product building</div>
            <div id="business-tasks"></div>
            <button class="add-task-btn" onclick="addTask('business')">+ Add Task</button>
        </div>
        
        <div class="section leisure">
            <h2>üé® Leisure</h2>
            <div class="section-description">Intentional play, consuming media, and exploring joy</div>
            <div id="leisure-tasks"></div>
            <button class="add-task-btn" onclick="addTask('leisure')">+ Add Task</button>
        </div>
        
        <div class="section vanity">
            <h2>üíÖ Vanity</h2>
            <div class="section-description">Skincare, fashion, and beauty rituals that fuel confidence</div>
            <div id="vanity-tasks"></div>
            <button class="add-task-btn" onclick="addTask('vanity')">+ Add Task</button>
        </div>
        
        <div class="section health">
            <h2>üåø Health</h2>
            <div class="section-description">Movement, mindfulness, meals, or rest</div>
            <div id="health-tasks"></div>
            <button class="add-task-btn" onclick="addTask('health')">+ Add Task</button>
        </div>
        
        <div class="section home">
            <h2>üè° Home</h2>
            <div class="section-description">Tidying, organizing, decorating, or improving your space</div>
            <div id="home-tasks"></div>
            <button class="add-task-btn" onclick="addTask('home')">+ Add Task</button>
        </div>
        
        <!-- Creative Workflow Section -->
        <div class="section creative-workflow">
            <h2>‚ú® Creative Flow: PRODUCE ‚Ä¢ RECOVER ‚Ä¢ DISCOVER</h2>
            <div class="workflow-grid">
                <div class="workflow-section">
                    <h3>üé¨ PRODUCE</h3>
                    <div class="examples">Create something new: Record a video, draft a post, write a script, build a graphic</div>
                    <div id="produce-tasks"></div>
                    <button class="add-task-btn" onclick="addTask('produce')">+ Add Task</button>
                </div>
                
                <div class="workflow-section">
                    <h3>‚ôªÔ∏è RECOVER</h3>
                    <div class="examples">Revisit unfinished ideas: Finish an outline, revise a blog post, turn notes into content</div>
                    <div id="recover-tasks"></div>
                    <button class="add-task-btn" onclick="addTask('recover')">+ Add Task</button>
                </div>
                
                <div class="workflow-section">
                    <h3>üîç DISCOVER</h3>
                    <div class="examples">Feed the pipeline: Read articles, watch videos for inspiration, research trends</div>
                    <div id="discover-tasks"></div>
                    <button class="add-task-btn" onclick="addTask('discover')">+ Add Task</button>
                </div>
            </div>
        </div>
        
        <!-- Goal Milestones Section -->
        <div class="section goal-milestones">
            <h2>üéØ Goal Milestones</h2>
            <div class="section-description">Track progress toward your major creative objectives</div>
            <div id="goals-container"></div>
        </div>
        
        <!-- Brain Dump Section -->
        <div class="section brain-dump">
            <h2>üß† Brain Dump</h2>
            <div class="section-description">Capture any thoughts, ideas, or random notes here</div>
            <textarea placeholder="Let your thoughts flow here..."></textarea>
        </div>
        
        <!-- Daily Summary Section -->
        <div class="section daily-summary">
            <h2>üìä Daily Summary</h2>
            <div class="section-description">Review your day's progress and accomplishments</div>
            
            <div class="summary-controls">
                <button class="summary-btn primary" onclick="generateDailySummary()">üìã Generate Today's Summary</button>
                <button class="summary-btn" onclick="exportSummary()">üíæ Export Summary</button>
            </div>
            
            <div class="summary-content" id="summaryContent">
                <div class="summary-placeholder">Click "Generate Today's Summary" to see your daily progress!</div>
            </div>
        </div>
    </div>
    
    <script>
        // Set current date
        document.getElementById('currentDate').textContent = new Date().toLocaleDateString('en-US', { 
            weekday: 'long', 
            year: 'numeric', 
            month: 'long', 
            day: 'numeric' 
        });
        
        let taskCounter = 0;
        let currentSuggestion = null;
        let currentPriorities = {};
        
        // Initialize with one task per category
        const categories = ['work', 'education', 'relationships', 'money', 'business', 'leisure', 'vanity', 'health', 'home', 'produce', 'recover', 'discover'];
        const empireCategories = ['empire-priorities', 'empire-deadlines', 'empire-revenue', 'empire-opportunities'];
        
        // Default goals
        const defaultGoals = [
            {
                id: 'new-yorker',
                title: 'Get Published in The New Yorker',
                milestones: [
                    { text: 'Study 10 recent New Yorker pieces in my genre', completed: false },
                    { text: 'Draft 3 potential submission pieces', completed: false },
                    { text: 'Get feedback from trusted critics', completed: false },
                    { text: 'Submit polished piece to New Yorker', completed: false },
                    { text: 'Follow up on submission', completed: false }
                ]
            },
            {
                id: 'cultural-authority',
                title: 'Build Cultural Criticism Authority',
                milestones: [
                    { text: 'Launch newsletter with consistent schedule', completed: false },
                    { text: 'Publish 20 high-quality criticism pieces', completed: false },
                    { text: 'Build audience of 1000+ engaged subscribers', completed: false },
                    { text: 'Get quoted as expert in major publication', completed: false },
                    { text: 'Book speaking opportunities at conferences', completed: false }
                ]
            },
            {
                id: 'creative-empire',
                title: 'Build Creative Empire Business',
                milestones: [
                    { text: 'Launch signature content series', completed: false },
                    { text: 'Create premium subscription tiers', completed: false },
                    { text: 'Secure 3 brand partnerships', completed: false },
                    { text: 'Develop online course or workshop', completed: false },
                    { text: 'Hit $10K/month revenue goal', completed: false }
                ]
            },
            {
                id: 'book-deal',
                title: 'Secure Book Deal',
                milestones: [
                    { text: 'Complete book proposal', completed: false },
                    { text: 'Write 3 sample chapters', completed: false },
                    { text: 'Research and list target agents', completed: false },
                    { text: 'Submit to 10 literary agents', completed: false },
                    { text: 'Sign with agent and publisher', completed: false }
                ]
            }
        ];
        
        function updateSyncStatus(message) {
            const statusEl = document.getElementById('syncStatus');
            if (statusEl) {
                statusEl.textContent = message;
            }
        }
        
        function getDateString(date = new Date()) {
            return date.toDateString();
        }
        
        function getYesterdayString() {
            const yesterday = new Date();
            yesterday.setDate(yesterday.getDate() - 1);
            return yesterday.toDateString();
        }
        
        function saveData() {
            try {
                updateSyncStatus('üîÑ Syncing...');
                const data = getCurrentDayData();
                const todayKey = getDateString();
                
                // Save to localStorage first (backup)
                localStorage.setItem(todayKey, JSON.stringify(data));
                
                // Save to Firebase
                db.collection('productivity').doc(todayKey)
                    .set({
                        ...data,
                        lastUpdated: firebase.firestore.FieldValue.serverTimestamp()
                    })
                    .then(() => {
                        updateSyncStatus('‚òÅ Cloud Synced');
                        setTimeout(() => {
                            updateSyncStatus('Ready to Track');
                        }, 2000);
                    })
                    .catch((error) => {
                        console.error('Firebase save error:', error);
                        updateSyncStatus('‚ö† Local Only');
                    });
                    
            } catch (error) {
                console.error('Save error:', error);
                updateSyncStatus('‚ùå Save failed');
            }
        }
        
        function loadData(date = getDateString()) {
            try {
                updateSyncStatus('üì• Loading...');
                
                // Try Firebase first
                db.collection('productivity').doc(date)
                    .get()
                    .then((doc) => {
                        if (doc.exists) {
                            const data = doc.data();
                            delete data.lastUpdated; // Remove Firebase timestamp
                            loadDataIntoUI(data);
                            updateSyncStatus('‚òÅ Cloud Loaded');
                            
                            // Update localStorage with cloud data
                            localStorage.setItem(date, JSON.stringify(data));
                        } else {
                            // No cloud data, try localStorage
                            const localData = localStorage.getItem(date);
                            if (localData) {
                                const parsedData = JSON.parse(localData);
                                loadDataIntoUI(parsedData);
                                updateSyncStatus('üì± Local Data');
                            } else {
                                initializeEmptyTasks();
                                updateSyncStatus('Ready to Track');
                            }
                        }
                    })
                    .catch((error) => {
                        console.error('Firebase load error:', error);
                        // Fallback to localStorage
                        const data = localStorage.getItem(date);
                        if (data) {
                            const parsedData = JSON.parse(data);
                            loadDataIntoUI(parsedData);
                            updateSyncStatus('üì± Local Data');
                        } else {
                            initializeEmptyTasks();
                            updateSyncStatus('Ready to Track');
                        }
                    });
                    
            } catch (error) {
                console.error('Load error:', error);
                initializeEmptyTasks();
                updateSyncStatus('‚ùå Load failed');
            }
        }
        
        function loadYesterdayReview() {
            try {
                const yesterdayKey = getYesterdayString();
                
                // Try Firebase first
                db.collection('productivity').doc(yesterdayKey)
                    .get()
                    .then((doc) => {
                        if (doc.exists) {
                            const data = doc.data();
                            delete data.lastUpdated;
                            displayYesterdayReview(data);
                        } else {
                            // Try localStorage
                            const localData = localStorage.getItem(yesterdayKey);
                            if (localData) {
                                const parsedData = JSON.parse(localData);
                                displayYesterdayReview(parsedData);
                            } else {
                                hideYesterdayReview();
                            }
                        }
                    })
                    .catch((error) => {
                        console.error('Yesterday review error:', error);
                        hideYesterdayReview();
                    });
                    
            } catch (error) {
                console.error('Error loading yesterday data:', error);
                hideYesterdayReview();
            }
        }
        
        function getCurrentDayData() {
            const data = {};
            
            // Get regular category tasks
            categories.forEach(category => {
                const container = document.getElementById(category + '-tasks');
                const tasks = [];
                
                if (container) {
                    container.querySelectorAll('.task-input').forEach(taskDiv => {
                        const checkbox = taskDiv.querySelector('input[type="checkbox"]');
                        const textInput = taskDiv.querySelector('input[type="text"]');
                        const priority = taskDiv.dataset.priority || 'none';
                        
                        if (textInput && textInput.value.trim()) {
    tasks.push({
        text: textInput.value,
        completed: checkbox.checked,
        priority: priority,
        timeSpent: parseInt(taskDiv.dataset.timeSpent) || 0
    });
}
                    });
                }
                
                data[category] = tasks;
            });
            
            // Get empire integration tasks
            empireCategories.forEach(category => {
                const container = document.getElementById(category);
                const tasks = [];
                
                if (container) {
                    container.querySelectorAll('.empire-task-input').forEach(taskDiv => {
                        const checkbox = taskDiv.querySelector('input[type="checkbox"]');
                        const textInput = taskDiv.querySelector('input[type="text"]');
                        
                        if (textInput && textInput.value.trim()) {
                            tasks.push({
                                text: textInput.value,
                                completed: checkbox.checked
                            });
                        }
                    });
                }
                
                data[category] = tasks;
            });
            
            // Get brain dump
            const brainDump = document.querySelector('.brain-dump textarea');
            data.brainDump = brainDump ? brainDump.value : '';
            
            // Get goals
            data.goals = getCurrentGoalData();
            
            // Get streaks
            data.streaks = {
                writing: parseInt(document.getElementById('writingStreak').textContent) || 0,
                submission: parseInt(document.getElementById('submissionStreak').textContent) || 0,
                authority: parseInt(document.getElementById('authorityStreak').textContent) || 0,
                newsletter: parseInt(document.getElementById('newsletterStreak').textContent) || 0
            };
            
            return data;
        }
        
        function loadDataIntoUI(data) {
            // Load regular tasks
            categories.forEach(category => {
                if (data[category] && Array.isArray(data[category])) {
                    const container = document.getElementById(category + '-tasks');
                    if (container) {
                        container.innerHTML = '';
                        data[category].forEach(task => {
                            if (task.text && task.text.trim()) {
const taskDiv = createTaskElement(category, task.text, task.completed, task.priority, task.timeSpent || 0);                                container.appendChild(taskDiv);
                            }
                        });
                        // Add an empty task
                        addTask(category);
                    }
                }
            });
            
            // Load empire tasks
            empireCategories.forEach(category => {
                if (data[category] && Array.isArray(data[category])) {
                    const container = document.getElementById(category);
                    if (container) {
                        container.innerHTML = '';
                        data[category].forEach(task => {
                            if (task.text && task.text.trim()) {
                                const taskDiv = createEmpireTaskElement(category, task.text, task.completed);
                                container.appendChild(taskDiv);
                            }
                        });
                        // Add an empty task
                        addEmpireTask(category);
                    }
                }
            });
            
            // Load brain dump
            if (data.brainDump) {
                const textarea = document.querySelector('.brain-dump textarea');
                if (textarea) {
                    textarea.value = data.brainDump;
                    textarea.addEventListener('input', saveData);
                }
            }
            
            // Load goals
            if (data.goals) {
                loadGoalData(data.goals);
            }
            
            // Load streaks
            if (data.streaks) {
                document.getElementById('writingStreak').textContent = data.streaks.writing || 0;
                document.getElementById('submissionStreak').textContent = data.streaks.submission || 0;
                document.getElementById('authorityStreak').textContent = data.streaks.authority || 0;
                document.getElementById('newsletterStreak').textContent = data.streaks.newsletter || 0;
            }
            
            updateCompletedCount();
            updateStreaks();
        }
        
        function initializeEmptyTasks() {
            categories.forEach(category => {
                const container = document.getElementById(category + '-tasks');
                if (container && container.children.length === 0) {
                    addTask(category);
                }
            });
            
            empireCategories.forEach(category => {
                const container = document.getElementById(category);
                if (container && container.children.length === 0) {
                    addEmpireTask(category);
                }
            });
            
            // Initialize goals
            initializeGoals();
        }
        
       function createTaskElement(category, text = '', completed = false, priority = 'none', timeSpent = 0) {
    const taskDiv = document.createElement('div');
    taskDiv.className = 'task-input';
    taskDiv.dataset.priority = priority;
    taskDiv.dataset.timeSpent = timeSpent;
    
    taskDiv.innerHTML = `
        <input type="checkbox" id="task-${taskCounter}" ${completed ? 'checked' : ''} 
            onchange="updateCompletedCount(); updateStreaks(); saveData();">
        <div class="priority-buttons">
            <button class="priority-btn ${priority === 'empire' ? 'active' : ''}" 
                onclick="setPriority(this, 'empire')" title="Empire Critical">üèõ‚ö°</button>
            <button class="priority-btn ${priority === 'high' ? 'active' : ''}" 
                onclick="setPriority(this, 'high')" title="High Impact">üöÄüí•</button>
            <button class="priority-btn ${priority === 'maintenance' ? 'active' : ''}" 
                onclick="setPriority(this, 'maintenance')" title="Maintenance">üîßüõ†</button>
        </div>
        <input type="text" placeholder="Enter your task here..." 
            value="${text}"
            onkeypress="handleEnter(event, '${category}')"
            onchange="saveData()">
        <div class="time-tracking">
            <button class="time-btn" onclick="addTime(this, 15)">+15m</button>
            <button class="time-btn" onclick="addTime(this, 30)">+30m</button>
            <button class="time-btn" onclick="addTime(this, 60)">+1h</button>
            <span class="time-display">${formatTime(timeSpent)}</span>
        </div>
    `;
    
    taskCounter++;
    return taskDiv;
}
        function addTime(button, minutes) {
    const taskDiv = button.closest('.task-input');
    const currentTime = parseInt(taskDiv.dataset.timeSpent) || 0;
    const newTime = currentTime + minutes;
    taskDiv.dataset.timeSpent = newTime;
    
    // Update display
    const timeDisplay = taskDiv.querySelector('.time-display');
    timeDisplay.textContent = formatTime(newTime);
    
    // Update total time
    updateTotalTime();
    saveData();
}

function formatTime(minutes) {
    if (minutes === 0) return '';
    if (minutes < 60) return `${minutes}m`;
    const hours = Math.floor(minutes / 60);
    const mins = minutes % 60;
    return mins > 0 ? `${hours}h ${mins}m` : `${hours}h`;
}

function updateTotalTime() {
    let totalMinutes = 0;
    document.querySelectorAll('.task-input').forEach(taskDiv => {
        const time = parseInt(taskDiv.dataset.timeSpent) || 0;
        totalMinutes += time;
    });
    
    // Update the stats display
    const statsDiv = document.querySelector('.stats');
    let timeElement = document.getElementById('totalTime');
    if (!timeElement) {
        // Add total time to stats if not there
        const syncStatus = document.getElementById('syncStatus');
        timeElement = document.createElement('div');
        timeElement.id = 'totalTime';
        timeElement.style.marginTop = '8px';
        statsDiv.insertBefore(timeElement, syncStatus);
    }
    timeElement.innerHTML = `<strong>Time Today:</strong> ${formatTime(totalMinutes)}`;
}
        
        function createEmpireTaskElement(category, text = '', completed = false) {
            const taskDiv = document.createElement('div');
            taskDiv.className = 'empire-task-input';
            
            taskDiv.innerHTML = `
                <input type="checkbox" id="empire-task-${taskCounter}" ${completed ? 'checked' : ''} 
                    onchange="updateCompletedCount(); saveData();">
                <input type="text" placeholder="Enter your task here..." 
                    value="${text}"
                    onkeypress="handleEmpireEnter(event, '${category}')"
                    onchange="saveData()">
            `;
            
            taskCounter++;
            return taskDiv;
        }
        
        function addTask(category) {
            const container = document.getElementById(category + '-tasks');
            const taskDiv = createTaskElement(category);
            container.appendChild(taskDiv);
            
            const inputs = taskDiv.querySelectorAll('input[type="text"]');
            inputs[inputs.length - 1].focus();
        }
        
        function addEmpireTask(category) {
            const container = document.getElementById(category);
            const taskDiv = createEmpireTaskElement(category);
            container.appendChild(taskDiv);
            
            const inputs = taskDiv.querySelectorAll('input[type="text"]');
            inputs[inputs.length - 1].focus();
        }
        
        function handleEnter(event, category) {
            if (event.key === 'Enter') {
                addTask(category);
            }
        }
        
        function handleEmpireEnter(event, category) {
            if (event.key === 'Enter') {
                addEmpireTask(category);
            }
        }
        
        function setPriority(button, priority) {
            const taskDiv = button.closest('.task-input');
            const priorityButtons = taskDiv.querySelectorAll('.priority-btn');
            
            // Toggle off if clicking the same priority
            if (button.classList.contains('active')) {
                button.classList.remove('active');
                taskDiv.dataset.priority = 'none';
            } else {
                // Remove active from all buttons
                priorityButtons.forEach(btn => btn.classList.remove('active'));
                // Add active to clicked button
                button.classList.add('active');
                taskDiv.dataset.priority = priority;
            }
            
            saveData();
        }
        
        function updateCompletedCount() {
            // Get only today's data
            const todayData = getCurrentDayData();
            let completed = 0;
            
            // Count completed tasks only from today's data
            Object.keys(todayData).forEach(category => {
                if (category !== 'brainDump' && category !== 'goals' && category !== 'streaks' && Array.isArray(todayData[category])) {
                    completed += todayData[category].filter(task => task.completed).length;
                }
            });
            
            document.getElementById('completedCount').textContent = completed;
        }
        
        function updateStreaks() {
            const todayData = getCurrentDayData();
            
            // Update streaks based on completed Empire Critical tasks
            let hasWriting = false;
            let hasSubmission = false;
            let hasAuthority = false;
            let hasNewsletter = false;
            
            Object.keys(todayData).forEach(category => {
                if (Array.isArray(todayData[category])) {
                    todayData[category].forEach(task => {
                        if (task.completed && task.priority === 'empire') {
                            const taskText = task.text.toLowerCase();
                            
                            if (taskText.includes('write') || taskText.includes('draft') || taskText.includes('blog')) {
                                hasWriting = true;
                            }
                            if (taskText.includes('submit') || taskText.includes('pitch') || taskText.includes('send')) {
                                hasSubmission = true;
                            }
                            if (taskText.includes('post') || taskText.includes('tweet') || taskText.includes('comment')) {
                                hasAuthority = true;
                            }
                            if (taskText.includes('newsletter') || taskText.includes('email') || taskText.includes('subscriber')) {
                                hasNewsletter = true;
                            }
                        }
                    });
                }
            });
            
            // Update streak displays (simplified for demo)
            if (hasWriting) {
                const current = parseInt(document.getElementById('writingStreak').textContent) || 0;
                document.getElementById('writingStreak').textContent = current + 1;
            }
            if (hasSubmission) {
                const current = parseInt(document.getElementById('submissionStreak').textContent) || 0;
                document.getElementById('submissionStreak').textContent = current + 1;
            }
            if (hasAuthority) {
                const current = parseInt(document.getElementById('authorityStreak').textContent) || 0;
                document.getElementById('authorityStreak').textContent = current + 1;
            }
            if (hasNewsletter) {
                const current = parseInt(document.getElementById('newsletterStreak').textContent) || 0;
                document.getElementById('newsletterStreak').textContent = current + 1;
            }
        }
        
        // Goal-aligned suggestions
        const suggestions = {
            career: [
                "Draft a pitch for a major publication like The New Yorker",
                "Record a 5-minute video sharing your sharp take on a current event",
                "Write 3 original, thought-provoking social media posts",
                "Outline a concept for your own show or media brand",
                "Create a visually stunning graphic to accompany your next piece",
                "Research and draft commentary on a trending political topic",
                "Start writing a script for a 'Read & React' style video",
                "Design a media kit that showcases your intellectual authority",
                "Brainstorm 10 original angles on popular topics in your field",
                "Write a compelling bio that positions you as a thought leader",
                "Draft a submission for The New Yorker's 'Shouts & Murmurs' section",
                "Write a cultural criticism piece analyzing a current fashion or beauty trend",
                "Research and reach out to 3 editors at publications similar to The New Yorker",
                "Draft a book proposal for your racialized aesthetics book",
                "Create a media kit showcasing your cultural criticism expertise",
                "Write a detailed analysis of a recent fashion documentary",
                "Pitch yourself as a cultural commentator to 3 podcasts",
                "Draft a letter to a celebrity you'd want to interview",
                "Create a Twitter thread analyzing current media representation",
                "Share your hot take on a trending cultural moment"
            ],
            wealth: [
                "Research 3 potential brand partnership opportunities",
                "Draft a proposal for a premium subscription tier",
                "Calculate your target monthly income and reverse-engineer the steps",
                "Create a pricing strategy for a new digital product",
                "Reach out to one potential speaking engagement contact",
                "Analyze your most profitable content and plan to create more",
                "Set up a system to track all income streams",
                "Research successful creators in your space and their business models",
                "Draft an email pitch for a lucrative collaboration",
                "Create a one-page business plan for your creative empire",
                "Create a pitch deck for your 'Taste of Kimberly' newsletter",
                "Calculate pricing strategy for Taste of Kimberly subscriptions",
                "Research 3 brands that could sponsor your newsletter",
                "Draft a media kit for potential brand partnerships",
                "Plan content calendar for your next month of posts",
                "Create a survey to understand your audience's interests"
            ],
            growth: [
                "Read one article from a prestigious publication and take notes",
                "Listen to 20 minutes of an intellectually stimulating podcast",
                "Research a trending topic and collect 5 interesting statistics",
                "Turn your recent reading highlights into potential content ideas",
                "Watch a cultural commentary video and write your own response",
                "Read the first chapter of a book that challenges your thinking",
                "Subscribe to a new newsletter from a thought leader you admire",
                "Research an academic paper related to your interests",
                "Create a system to capture and organize your best ideas",
                "Follow 3 new accounts that share high-quality intellectual content",
                "Watch one fashion documentary from your list and take detailed notes",
                "Research the submission guidelines for 5 literary magazines",
                "Study the structure of 3 recent New Yorker cultural criticism pieces",
                "Read one essay by Andrea Long Chu and analyze her approach",
                "Research Leandra M. Cohen's early career trajectory for insights",
                "Take notes on the latest issue of a high-end fashion magazine"
            ],
            home: [
                "Rearrange one corner of your space to be more inspiring",
                "Research and save 5 beautiful home decor ideas on Pinterest",
                "Declutter your desk area for better creative focus",
                "Add one beautiful object to your most-used workspace",
                "Research neighborhoods or homes you'd love to live in",
                "Create a mood board for your ideal living space",
                "Organize your books in a way that sparks joy",
                "Light a candle and appreciate your current environment",
                "Take a photo of the most beautiful corner of your home",
                "Research one home improvement that would boost your creativity"
            ],
            wellness: [
                "Take a 10-minute walk while listening to something inspiring",
                "Do 5 minutes of stretching or gentle movement",
                "Prepare one nourishing meal that makes you feel good",
                "Practice 5 minutes of deep breathing or meditation",
                "Take a luxurious shower or bath as a reset ritual",
                "Write down 3 things you're grateful for today",
                "Schedule time for rest without guilt",
                "Dance to one song that makes you feel powerful",
                "Step outside and get some natural light",
                "Plan one joyful activity for this week"
            ],
            vanity: [
                "Try a new makeup look that makes you feel powerful",
                "Organize your closet and plan 3 outfits that tell your story",
                "Take a few photos of yourself looking confident",
                "Research a beauty trend you want to try",
                "Put together an outfit that makes you feel like your best self",
                "Do a skincare routine that feels luxurious",
                "Practice your signature pose or expression in the mirror",
                "Choose accessories that elevate your daily look",
                "Plan your outfit for tomorrow with intention",
                "Write a sample 'Shallow Side' newsletter issue to test your format",
                "Write a LinkedIn post about your unique perspective on aesthetics",
                "Create a mood board that demonstrates your aesthetic eye"
            ],
            relationships: [
                "Send a thoughtful message to someone who supports your work",
                "Comment meaningfully on 3 posts from people in your community",
                "Reach out to a creator you admire for a potential collaboration",
                "Write a post that invites your audience to share their thoughts",
                "Schedule a coffee date with someone who inspires you",
                "Thank someone who has helped your career or creativity",
                "Join a conversation in your field on social media",
                "Plan a way to give value to your community this week",
                "Reach out to an old friend who might enjoy your current work",
                "Engage with your Patreon community or create content for them",
                "Research and connect with 3 Black women cultural critics on social media",
                "Plan the format and guest list for your first Salon Noire event",
                "Reach out to one potential collaborator for 'Black Women in The Wild'",
                "Draft invitation copy for a supper club event",
                "Connect with 2 people who could be interview subjects",
                "Comment thoughtfully on 5 posts by established cultural critics"
            ]
        };
        
        function getRandomSuggestion() {
            const allSuggestions = Object.values(suggestions).flat();
            const allCategories = Object.keys(suggestions);
            
            const randomSuggestion = allSuggestions[Math.floor(Math.random() * allSuggestions.length)];
            const category = allCategories.find(cat => suggestions[cat].includes(randomSuggestion));
            
            displaySuggestion(randomSuggestion, category);
        }
        
        function getSuggestionByCategory() {
            const selectedCategory = document.getElementById('categoryFilter').value;
            if (!selectedCategory) return;
            
            const categorySuggestions = suggestions[selectedCategory];
            const randomSuggestion = categorySuggestions[Math.floor(Math.random() * categorySuggestions.length)];
            
            displaySuggestion(randomSuggestion, selectedCategory);
        }
        
        function displaySuggestion(text, category) {
            const categoryNames = {
                career: 'üìù Career & Creativity',
                wealth: 'üíº Wealth & Business',
                growth: 'üìö Growth & Learning',
                home: 'üè° Home & Environment',
                wellness: 'üå± Wellness & Health',
                vanity: '‚ú® Vanity & Visibility',
                relationships: 'üíï Relationships & Community'
            };
            
            currentSuggestion = { text, category };
            
            document.getElementById('currentSuggestion').innerHTML = `
                <div class="suggestion-text">${text}</div>
                <div class="suggestion-category">${categoryNames[category]}</div>
            `;
        }
        
        function getAnotherSuggestion() {
            const filter = document.getElementById('categoryFilter').value;
            if (filter) {
                getSuggestionByCategory();
            } else {
                getRandomSuggestion();
            }
        }
        
        function addSuggestionAsTask() {
            if (!currentSuggestion) return;
            
            const categoryMap = {
                career: 'work',
                wealth: 'business',
                growth: 'education',
                home: 'home',
                wellness: 'health',
                vanity: 'vanity',
                relationships: 'relationships'
            };
            
            const targetCategory = categoryMap[currentSuggestion.category];
            if (!targetCategory) return;
            
            const container = document.getElementById(targetCategory + '-tasks');
            const taskDiv = createTaskElement(targetCategory, currentSuggestion.text, false, 'empire');
            
            // Find the last task input
            const existingTasks = container.querySelectorAll('.task-input');
            if (existingTasks.length > 0) {
                const lastTask = existingTasks[existingTasks.length - 1];
                const lastInput = lastTask.querySelector('input[type="text"]');
                
                // If the last task is empty, replace it
                if (!lastInput.value.trim()) {
                    container.replaceChild(taskDiv, lastTask);
                } else {
                    container.appendChild(taskDiv);
                }
            } else {
                container.appendChild(taskDiv);
            }
            
            // Add an empty task for the next input
            addTask(targetCategory);
            
            saveData();
            
            // Visual feedback
            const suggestionEl = document.getElementById('currentSuggestion');
            const originalBg = suggestionEl.style.background;
            suggestionEl.style.background = 'rgba(46, 204, 113, 0.3)';
            setTimeout(() => {
                suggestionEl.style.background = originalBg;
            }, 1000);
        }
        
        function displayYesterdayReview(data) {
            const categoryNames = {
                work: 'üíº Work',
                education: 'üìö Education',
                relationships: 'üíù Relationships',
                money: 'üí∞ Money',
                business: 'üöÄ Business',
                leisure: 'üé® Leisure',
                vanity: 'üíÖ Vanity',
                health: 'üåø Health',
                home: 'üè° Home',
                produce: 'üé¨ Produce',
                recover: '‚ôªÔ∏è Recover',
                discover: 'üîç Discover'
            };
            
            const priorityLabels = {
                'empire': 'üèõ‚ö°',
                'high': 'üöÄüí•',
                'maintenance': 'üîßüõ†',
                'none': ''
            };
            
            let completedTasks = [];
            let totalCompleted = 0;
            
            Object.keys(data).forEach(category => {
                if (category === 'brainDump' || category === 'lastUpdated' || category === 'goals' || category === 'streaks') return;
                
                if (Array.isArray(data[category])) {
                    data[category].forEach(task => {
                        if (task.completed && task.text && typeof task.text === 'string' && task.text.trim()) {
                            completedTasks.push({
                                text: task.text,
                                category: categoryNames[category] || category,
                                priority: task.priority || 'none'
                            });
                            totalCompleted++;
                        }
                    });
                }
            });
            
            // Only show the section if there are actually completed tasks
            if (totalCompleted > 0) {
                document.getElementById('yesterdayCount').textContent = totalCompleted;
                document.getElementById('streakCount').textContent = calculateStreak();
                
                const tasksContainer = document.getElementById('yesterdayTasks');
                tasksContainer.innerHTML = completedTasks.map(task => `
                    <div class="yesterday-task-item">
                        <span class="task-category-badge">${task.category}</span>
                        ${task.priority !== 'none' ? `<span>${priorityLabels[task.priority]}</span>` : ''}
                        <span>${task.text}</span>
                    </div>
                `).join('');
                
                document.getElementById('yesterdaySection').style.display = 'block';
            } else {
                hideYesterdayReview();
            }
        }
        
        function calculateStreak() {
            // Simple streak calculation - in a real app, this would check consecutive days
            return Math.floor(Math.random() * 7) + 1;
        }
        
        function hideYesterdayReview() {
            document.getElementById('yesterdaySection').style.display = 'none';
        }
        
        // Goal Milestones Functions
        function initializeGoals() {
            const container = document.getElementById('goals-container');
            container.innerHTML = '';
            
            defaultGoals.forEach(goal => {
                const goalCard = createGoalCard(goal);
                container.appendChild(goalCard);
            });
        }
        
        function createGoalCard(goal) {
            const completed = goal.milestones.filter(m => m.completed).length;
            const total = goal.milestones.length;
            const percentage = (completed / total) * 100;
            
            const card = document.createElement('div');
            card.className = 'goal-card';
            card.id = `goal-${goal.id}`;
            
            card.innerHTML = `
                <div class="goal-header">
                    <div class="goal-title">${goal.title}</div>
                    <div class="goal-progress">
                        <span class="progress-text">${completed}/${total}</span>
                    </div>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: ${percentage}%"></div>
                </div>
                <ul class="milestone-list">
                    ${goal.milestones.map((milestone, index) => `
                        <li class="milestone-item ${milestone.completed ? 'completed' : ''}">
                            <input type="checkbox" class="milestone-checkbox" 
                                ${milestone.completed ? 'checked' : ''}
                                onchange="updateGoalProgress('${goal.id}', ${index}); saveData();">
                            <span class="milestone-text">${milestone.text}</span>
                        </li>
                    `).join('')}
                </ul>
                <button class="add-milestone-btn" onclick="addMilestone('${goal.id}')">+ Add Milestone</button>
            `;
            
            return card;
        }
        
        function updateGoalProgress(goalId, milestoneIndex) {
            const goal = defaultGoals.find(g => g.id === goalId);
            if (goal && goal.milestones[milestoneIndex]) {
                goal.milestones[milestoneIndex].completed = !goal.milestones[milestoneIndex].completed;
                
                // Recreate the goal card
                const container = document.getElementById('goals-container');
                const oldCard = document.getElementById(`goal-${goalId}`);
                const newCard = createGoalCard(goal);
                container.replaceChild(newCard, oldCard);
            }
        }
        
        function addMilestone(goalId) {
            const goal = defaultGoals.find(g => g.id === goalId);
            if (goal) {
                const text = prompt('Enter new milestone:');
                if (text && text.trim()) {
                    goal.milestones.push({ text: text.trim(), completed: false });
                    
                    // Recreate the goal card
                    const container = document.getElementById('goals-container');
                    const oldCard = document.getElementById(`goal-${goalId}`);
                    const newCard = createGoalCard(goal);
                    container.replaceChild(newCard, oldCard);
                    
                    saveData();
                }
            }
        }
        
        function getCurrentGoalData() {
            return defaultGoals;
        }
        
        function loadGoalData(goals) {
            if (goals && Array.isArray(goals)) {
                // Update defaultGoals with loaded data
                goals.forEach(loadedGoal => {
                    const defaultGoal = defaultGoals.find(g => g.id === loadedGoal.id);
                    if (defaultGoal) {
                        defaultGoal.milestones = loadedGoal.milestones;
                    }
                });
                
                // Reinitialize goals display
                initializeGoals();
            }
        }
        
        // Daily Summary Functions
        function generateDailySummary() {
            const data = getCurrentDayData();
            const today = new Date().toLocaleDateString('en-US', { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            });
            
            let completedTasks = [];
            let totalCompleted = 0;
            
            const categoryNames = {
                work: 'üíº Work',
                education: 'üìö Education',
                relationships: 'üíù Relationships',
                money: 'üí∞ Money',
                business: 'üöÄ Business',
                leisure: 'üé® Leisure',
                vanity: 'üíÖ Vanity',
                health: 'üåø Health',
                home: 'üè° Home',
                produce: 'üé¨ Produce',
                recover: '‚ôªÔ∏è Recover',
                discover: 'üîç Discover'
            };
            
            const priorityLabels = {
                'empire': 'üèõ‚ö° Empire Critical',
                'high': 'üöÄüí• High Impact',
                'maintenance': 'üîßüõ† Maintenance',
                'none': ''
            };
            
            // Analyze tasks by category
            const categoryStats = {};
            
            Object.keys(data).forEach(category => {
                if (category === 'brainDump' || category === 'goals' || category === 'streaks') return;
                
                if (Array.isArray(data[category])) {
                    const tasks = data[category].filter(task => task.text && task.text.trim());
                    const completed = tasks.filter(task => task.completed);
                    
                    if (tasks.length > 0) {
                        categoryStats[category] = {
                            name: categoryNames[category] || category,
                            total: tasks.length,
                            completed: completed.length,
                            tasks: tasks
                        };
                        
                        totalCompleted += completed.length;
                        
                        // Add completed tasks to list
                        completed.forEach(task => {
                            completedTasks.push({
                                text: task.text,
                                category: categoryNames[category] || category,
                                priority: task.priority || 'none'
                            });
                        });
                    }
                }
            });
            
            // Generate summary HTML
            let summaryHTML = `
                <div class="summary-section">
                    <h3>üìÖ ${today}</h3>
                </div>
                
                <div class="summary-stats">
                    <div class="summary-stat">
                        <div class="summary-stat-number">${totalCompleted}</div>
                        <div class="summary-stat-label">Tasks Completed</div>
                    </div>
                </div>
                
                <div class="summary-section">
                    <h3>üí´ Today's Wins</h3>
                    <p>${getEncouragementMessage(totalCompleted)}</p>
                </div>
            `;
            
            // Add completed tasks if any
            if (completedTasks.length > 0) {
                summaryHTML += `
                    <div class="summary-section">
                        <h3>‚úÖ Accomplished Today</h3>
                        <ul class="summary-task-list">
                            ${completedTasks.map(task => `
                                <li class="summary-task-item">
                                    <strong>${task.category}:</strong> ${task.text}
                                    ${task.priority !== 'none' ? ` (${priorityLabels[task.priority]})` : ''}
                                </li>
                            `).join('')}
                        </ul>
                    </div>
                `;
            }
            
            // Add category breakdown
            if (Object.keys(categoryStats).length > 0) {
                summaryHTML += `
                    <div class="summary-section">
                        <h3>üìä Category Breakdown</h3>
                        ${Object.entries(categoryStats).map(([key, stats]) => `
                            <div style="margin-bottom: 10px;">
                                <strong>${stats.name}:</strong> ${stats.completed}/${stats.total} completed
                            </div>
                        `).join('')}
                    </div>
                `;
            }
            
            // Add brain dump if exists
            if (data.brainDump && data.brainDump.trim()) {
                summaryHTML += `
                    <div class="summary-section">
                        <h3>üß† Brain Dump</h3>
                        <div class="summary-brain-dump">${data.brainDump}</div>
                    </div>
                `;
            }
            
            document.getElementById('summaryContent').innerHTML = summaryHTML;
        }
        
        function getEncouragementMessage(completedTasks) {
            if (completedTasks >= 10) {
                return "üåü Incredible! You accomplished so much today!";
            } else if (completedTasks >= 7) {
                return "üéâ Fantastic work! You really made things happen today.";
            } else if (completedTasks >= 4) {
                return "üí™ Great progress! You tackled several important tasks.";
            } else if (completedTasks >= 1) {
                return "‚ú® Every task completed is a step forward. Well done!";
            } else {
                return "üå± Tomorrow is a fresh start with endless possibilities!";
            }
        }
        
        function exportSummary() {
            const summaryContent = document.getElementById('summaryContent');
            if (summaryContent.querySelector('.summary-placeholder')) {
                alert('Please generate a summary first!');
                return;
            }
            
            const data = getCurrentDayData();
            const today = new Date().toLocaleDateString('en-US', { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            });
            
            let exportText = `DAILY PRODUCTIVITY SUMMARY\n`;
            exportText += `${today}\n`;
            exportText += `${'='.repeat(50)}\n\n`;
            
            // Stats
            let totalCompleted = 0;
            Object.keys(data).forEach(category => {
                if (category === 'brainDump' || category === 'goals' || category === 'streaks') return;
                
                if (Array.isArray(data[category])) {
                    const completed = data[category].filter(task => task.completed && task.text && task.text.trim());
                    totalCompleted += completed.length;
                }
            });
            
            exportText += `OVERVIEW:\n`;
            exportText += `- Tasks Completed: ${totalCompleted}\n\n`;
            
            // Completed tasks
            exportText += `ACCOMPLISHMENTS:\n`;
            
            const categoryNames = {
                work: 'Work',
                education: 'Education',
                relationships: 'Relationships',
                money: 'Money',
                business: 'Business',
                leisure: 'Leisure',
                vanity: 'Vanity',
                health: 'Health',
                home: 'Home',
                produce: 'Produce',
                recover: 'Recover',
                discover: 'Discover'
            };
            
            const priorityLabels = {
                'empire': 'üèõ‚ö° Empire Critical',
                'high': 'üöÄüí• High Impact',
                'maintenance': 'üîßüõ† Maintenance',
                'none': ''
            };
            
            Object.keys(data).forEach(category => {
                if (category === 'brainDump' || category === 'goals' || category === 'streaks') return;
                
                if (Array.isArray(data[category])) {
                    const completed = data[category].filter(task => task.completed && task.text && task.text.trim());
                    
                    if (completed.length > 0) {
                        exportText += `\n${categoryNames[category] || category}:\n`;
                        completed.forEach(task => {
                            const priorityText = task.priority && task.priority !== 'none' ? ` (${priorityLabels[task.priority]})` : '';
                            exportText += `  ‚úì ${task.text}${priorityText}\n`;
                        });
                    }
                }
            });
            
            // Brain dump
            if (data.brainDump && data.brainDump.trim()) {
                exportText += `\nBRAIN DUMP:\n`;
                exportText += `${data.brainDump}\n`;
            }
            
            // Download as text file
            const blob = new Blob([exportText], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `daily-summary-${new Date().toISOString().split('T')[0]}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
        
        // Collapsible section functionality
        function toggleSection(sectionId) {
            const section = document.getElementById(sectionId);
            section.classList.toggle('collapsed');
        }
        
        function makeCollapsible() {
            const sections = document.querySelectorAll('.section:not(.yesterday-review):not(.empire-integration):not(.creative-streaks):not(.unstuck-suggestions):not(.creative-workflow):not(.brain-dump):not(.daily-summary):not(.goal-milestones)');
            
            sections.forEach(section => {
                const h2 = section.querySelector('h2');
                if (h2) {
                    const sectionId = section.id || 'section-' + Math.random().toString(36).substr(2, 9);
                    section.id = sectionId;
                    
                    const header = document.createElement('div');
                    header.className = 'section-header';
                    header.onclick = () => toggleSection(sectionId);
                    
                    const collapseIcon = document.createElement('span');
                    collapseIcon.className = 'collapse-icon';
                    collapseIcon.innerHTML = '‚ñº';
                    
                    h2.parentNode.insertBefore(header, h2);
                    header.appendChild(h2);
                    header.appendChild(collapseIcon);
                    
                    const content = document.createElement('div');
                    content.className = 'section-content';
                    
                    const nextSibling = h2.nextSibling;
                    while (nextSibling) {
                        const temp = nextSibling.nextSibling;
                        content.appendChild(nextSibling);
                        nextSibling = temp;
                    }
                    
                    section.appendChild(content);
                }
            });
        }
        
        // Real-time sync setup
        function setupRealtimeSync() {
            const todayKey = getDateString();
            
            db.collection('productivity').doc(todayKey)
                .onSnapshot((doc) => {
                    if (doc.exists && doc.metadata.hasPendingWrites === false) {
                        const data = doc.data();
                        delete data.lastUpdated;
                        loadDataIntoUI(data);
                        updateSyncStatus('‚òÅ Synced from another device!');
                        setTimeout(() => {
                            updateSyncStatus('‚òÅ Cloud Synced');
                        }, 3000);
                    }
                });
        }
        
        // Debug function
        function debugDateIssue() {
            console.log('Today string:', getDateString());
            console.log('Yesterday string:', getYesterdayString());
            console.log('Current date:', new Date());
            console.log('Today\'s data:', getCurrentDayData());
            
            // Check what's in localStorage
            const todayKey = getDateString();
            const localData = localStorage.getItem(todayKey);
            console.log('LocalStorage data for today:', localData);
        }
        
      // Initialize the app
// Initialize the app
window.addEventListener('load', async function() {
    debugDateIssue(); // Debug info
    loadYesterdayReview();
    loadData();
    makeCollapsible();
    setupRealtimeSync();
    updateTotalTime(); // ADD THIS LINE HERE
    
    // Set up brain dump auto-save with a slight delay to ensure DOM is ready
    setTimeout(() => {
        const textarea = document.querySelector('.brain-dump textarea');
        if (textarea) {
            // Remove any existing listeners first
            textarea.removeEventListener('input', saveData);
            // Add the event listener
            textarea.addEventListener('input', saveData);
            console.log('Brain dump auto-save initialized');
        } else {
            console.error('Brain dump textarea not found');
        }
    }, 100);
});
        
        // Auto-save every 30 seconds
        setInterval(saveData, 30000);
        
        // Save before page unload
        window.addEventListener('beforeunload', saveData);
        
        // Backup initialization
        setTimeout(() => {
            const allContainers = [...categories, ...empireCategories].map(cat => {
                if (empireCategories.includes(cat)) {
                    return document.getElementById(cat);
                } else {
                    return document.getElementById(cat + '-tasks');
                }
            });
            
            const hasAnyTasks = allContainers.some(container => 
                container && container.children.length > 0
            );
            
            if (!hasAnyTasks) {
                initializeEmptyTasks();
            }
        }, 100);
        
        function startFreshDay() {
    if (confirm('Start a fresh day? This will clear today\'s tasks but keep all previous days.')) {
        const todayKey = getDateString();
        localStorage.setItem(todayKey, '{}');
        db.collection('productivity').doc(todayKey).delete();
        location.reload();
    }
}
        // Weekly Review Functions with Firebase Integration
    async function loadWeeklyReview() {
    document.getElementById('weeklySection').style.display = 'block';
    document.getElementById('weeklyBreakdown').innerHTML = '<p style="text-align: center;">Loading weekly data...</p>';
    
    const weekData = {};
    let totalTasks = 0;
    let totalMinutes = 0;
    const categoryTotals = {};
    const dailyTotals = {};
    
    // Show loading state
    document.getElementById('weeklyTaskCount').textContent = '...';
    document.getElementById('weeklyTimeSpent').textContent = '...';
    
    // Collect data for the past 7 days
    for (let i = 0; i < 7; i++) {
        const date = new Date();
        date.setDate(date.getDate() - i);
        const dateKey = getDateString(date);
        const dayName = date.toLocaleDateString('en-US', { weekday: 'short' });
        
        try {
            // Try Firebase first
            const doc = await db.collection('productivity').doc(dateKey).get();
            let dayData = null;
            
            if (doc.exists) {
                dayData = doc.data();
                delete dayData.lastUpdated; // Remove Firebase timestamp
            } else {
                // Fall back to localStorage
                const localData = localStorage.getItem(dateKey);
                if (localData) {
                    dayData = JSON.parse(localData);
                }
            }
            
            if (dayData) {
                weekData[dateKey] = dayData;
                
                // Count tasks and time for this day
                let dayTasks = 0;
                let dayMinutes = 0;
                
                Object.keys(dayData).forEach(category => {
                    if (Array.isArray(dayData[category])) {
                        dayData[category].forEach(task => {
                            if (task.completed) {
                                dayTasks++;
                                totalTasks++;
                                const timeSpent = task.timeSpent || 0;
                                dayMinutes += timeSpent;
                                totalMinutes += timeSpent;
                                
                                // Track by category
                                if (!categoryTotals[category]) {
                                    categoryTotals[category] = { tasks: 0, time: 0 };
                                }
                                categoryTotals[category].tasks++;
                                categoryTotals[category].time += timeSpent;
                            }
                        });
                    }
                });
                
                dailyTotals[dayName] = { tasks: dayTasks, time: dayMinutes };
            }
        } catch (error) {
            console.error('Error loading day data:', dateKey, error);
        }
    }
    
    // Display results
    if (totalTasks > 0) {
        displayWeeklyReview(totalTasks, totalMinutes, categoryTotals, dailyTotals);
    } else {
        displayEmptyWeeklyReview();
    }
}

function displayWeeklyReview(totalTasks, totalMinutes, categoryTotals, dailyTotals) {
    // Update stats
    document.getElementById('weeklyTaskCount').textContent = totalTasks;
    document.getElementById('weeklyTimeSpent').textContent = formatTime(totalMinutes);
    const startDate = new Date();
startDate.setDate(startDate.getDate() - 6);
const dateRangeText = `${startDate.toLocaleDateString()} - ${new Date().toLocaleDateString()}`;
    // Add this after creating dateRangeText
document.getElementById('weeklySection').querySelector('.section-description').innerHTML = 
    `Your productivity patterns from ${dateRangeText}`;

    // Find most productive day
    let bestDay = '-';
    let maxTasks = 0;
    Object.entries(dailyTotals).forEach(([day, data]) => {
        if (data.tasks > maxTasks) {
            maxTasks = data.tasks;
            bestDay = day;
        }
    });
    document.getElementById('mostProductiveDay').textContent = bestDay;
    
    // Find top category
    let topCategory = '-';
    let maxCategoryTasks = 0;
    Object.entries(categoryTotals).forEach(([category, data]) => {
        if (data.tasks > maxCategoryTasks) {
            maxCategoryTasks = data.tasks;
            topCategory = category;
        }
    });
    
    const categoryNames = {
        work: 'üíº Work',
        education: 'üìö Education',
        relationships: 'üíù Relationships',
        money: 'üí∞ Money',
        business: 'üöÄ Business',
        leisure: 'üé® Leisure',
        vanity: 'üíÖ Vanity',
        health: 'üåø Health',
        home: 'üè° Home',
        produce: 'üé¨ Produce',
        recover: '‚ôªÔ∏è Recover',
        discover: 'üîç Discover'
    };
    
    document.getElementById('topCategory').textContent = categoryNames[topCategory] || topCategory;
    
    // Create category breakdown
    const sortedCategories = Object.entries(categoryTotals)
        .sort((a, b) => b[1].tasks - a[1].tasks)
        .slice(0, 5); // Top 5 categories
    
    const breakdownHTML = sortedCategories.map(([category, data]) => {
        const percentage = Math.round((data.tasks / totalTasks) * 100);
        return `
            <div class="category-bar">
                <div class="category-bar-label">
                    <span>${categoryNames[category] || category}</span>
                    <span>${data.tasks} tasks ‚Ä¢ ${formatTime(data.time)}</span>
                </div>
                <div class="category-bar-fill">
                    <div class="category-bar-progress" style="width: ${percentage}%">
                        ${percentage}%
                    </div>
                </div>
            </div>
        `;
    }).join('');
    
    document.getElementById('weeklyBreakdown').innerHTML = '<h3>Top Categories</h3>' + breakdownHTML;
    
    // Generate insights
    const insights = generateWeeklyInsights(totalTasks, totalMinutes, categoryTotals, dailyTotals);
    document.getElementById('weeklyInsights').innerHTML = '<h3>Weekly Insights</h3>' + insights;
    
    // Show the section
    document.getElementById('weeklySection').style.display = 'block';
}

function displayEmptyWeeklyReview() {
    document.getElementById('weeklyTaskCount').textContent = '0';
    document.getElementById('weeklyTimeSpent').textContent = '0h';
    document.getElementById('mostProductiveDay').textContent = '-';
    document.getElementById('topCategory').textContent = '-';
    
    document.getElementById('weeklyBreakdown').innerHTML = 
        '<p style="text-align: center; opacity: 0.8;">No completed tasks this week yet. Keep going!</p>';
    
    document.getElementById('weeklyInsights').innerHTML = 
        '<p style="text-align: center; opacity: 0.8;">Complete some tasks to see your weekly insights!</p>';
    
    document.getElementById('weeklySection').style.display = 'block';
}

function generateWeeklyInsights(totalTasks, totalMinutes, categoryTotals, dailyTotals) {
    const insights = [];
    
    // Productivity insight
    const avgTasksPerDay = Math.round(totalTasks / 7);
    insights.push(`You completed an average of ${avgTasksPerDay} tasks per day this week.`);
    
    // Time insight
    if (totalMinutes > 0) {
        const avgTimePerTask = Math.round(totalMinutes / totalTasks);
        insights.push(`Average time per task: ${formatTime(avgTimePerTask)}. ${avgTimePerTask > 60 ? 'Consider breaking down complex tasks.' : 'Great job keeping tasks manageable!'}`);
    }
    
    // Balance insight
    const activeCategories = Object.keys(categoryTotals).length;
    if (activeCategories < 5) {
        insights.push(`You focused on ${activeCategories} life areas. Consider adding tasks in other areas for better balance.`);
    } else {
        insights.push(`Great balance! You worked across ${activeCategories} different life areas.`);
    }
    
    // Empire building insight
    const empireCategories = ['work', 'business', 'education'];
    const empireTasks = empireCategories.reduce((sum, cat) => (categoryTotals[cat]?.tasks || 0) + sum, 0);
    if (totalTasks > 0) {
        const empirePercentage = Math.round((empireTasks / totalTasks) * 100);
        insights.push(`${empirePercentage}% of your tasks were empire-building activities. ${empirePercentage > 60 ? 'Strong focus on growth!' : 'Remember to invest in your empire!'}`);
    }
    
    return insights.map(insight => `<div class="insight-item">${insight}</div>`).join('');
}

function hideWeeklyReview() {
    document.getElementById('weeklySection').style.display = 'none';
}

function showWeeklyReview() {
    loadWeeklyReview();
}
    </script>
</body>
</html>
