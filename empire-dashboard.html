<!DOCTYPE html>
<html lang="en">
<head>
  <!-- =========================================================
       Empire Dashboard – Pro (Light‑Luxe)
       v2.3.1 |  Fix brandOrder chaining bug (TypeError)
       ---------------------------------------------------------
       * Replaced   brandOrder.slice().unshift('overview').forEach(...)
         with       [ 'overview', ...brandOrder ].forEach(...)
         because Array.prototype.unshift returns a number (new length),
         breaking the chain and throwing “forEach is not a function”.
       * No other functional changes.
  ========================================================= -->
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Empire Dashboard – Pro</title>
  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet">
  <!-- SortableJS (drag & drop) -->
  <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.2/Sortable.min.js"></script>
  <!-- Chart.js (sparklines) -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <style>
    :root{
      --bg:#fff;--bg-muted:#f8f8fc;--border:#e6e6f0;--text:#1a1a1a;--text-muted:#6e6e82;--accent:#8245ff;
      --accent-knf:#e63cff;--accent-fh:#652399;--accent-mtih:#006aff;--accent-sss:#ff5880;--accent-tok:#9e2fff;--accent-bwitw:#ffb600;--accent-indigo:#532dff;
      --card-shadow:0 2px 6px rgba(0,0,0,.05);
    }
    *{margin:0;padding:0;box-sizing:border-box;font-family:'Inter',sans-serif;}
    body{background:var(--bg);color:var(--text);line-height:1.5;padding-bottom:4rem;}
    h1{font-family:'Playfair Display',serif;font-weight:700;font-size:1.9rem;margin-bottom:1rem;}
    h2{font-family:'Playfair Display',serif;font-weight:700;font-size:1.45rem;margin-bottom:.3rem;}
    .container{max-width:1260px;margin:auto;padding:1.6rem;}
    /* nav */
    .nav{display:flex;flex-wrap:wrap;gap:.55rem;margin-bottom:1.35rem;}
    .nav-btn{padding:.45rem .95rem;border:1px solid var(--border);border-radius:7px;font-weight:600;font-size:.875rem;cursor:pointer;transition:.2s;background:var(--bg-muted);}    
    .nav-btn.active,.nav-btn:hover{background:var(--accent);color:#fff;border-color:var(--accent);}    
    /* totals */
    .totals{display:flex;gap:1rem;flex-wrap:wrap;margin-bottom:2.2rem;}
    .total-box{flex:1 1 160px;background:var(--bg-muted);border:1px solid var(--border);border-radius:10px;padding:1rem;text-align:center;box-shadow:var(--card-shadow);}    
    .total-val{font-family:'Playfair Display',serif;font-size:1.35rem;color:var(--accent);font-weight:700;}
    .total-label{font-size:.75rem;color:var(--text-muted);text-transform:uppercase;letter-spacing:.45px;}
    /* overview cards */
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:1.6rem;}
    .card{background:var(--bg);border:1px solid var(--border);border-radius:14px;padding:1.25rem;box-shadow:var(--card-shadow);transition:transform .25s,box-shadow .25s;cursor:pointer;}    
    .card:hover{transform:translateY(-4px) rotate(.4deg);box-shadow:0 6px 16px rgba(0,0,0,.08);}    
    .card[data-brand]{border-top:6px solid var(--accent);} /* accent overridden per brand */
    .card[data-brand="knf"]{--accent:var(--accent-knf);}   
    .card[data-brand="fh"]{--accent:var(--accent-fh);}    
    .card[data-brand="mtih"]{--accent:var(--accent-mtih);}  
    .card[data-brand="sss"]{--accent:var(--accent-sss);}   
    .card[data-brand="tok"]{--accent:var(--accent-tok);}   
    .card[data-brand="bwitw"]{--accent:var(--accent-bwitw);} 
    .card[data-brand="indigo"]{--accent:var(--accent-indigo);} 
    .badge{padding:.15rem .55rem;border-radius:999px;font-size:.7rem;font-weight:600;text-transform:lowercase;color:#fff;display:inline-block;}
    .badge.active{background:#4ade80;}.badge.launching{background:#f97316;}.badge.planning{background:#60a5fa;}
    .brand-title{font-family:'Playfair Display',serif;font-size:1.25rem;margin-bottom:.25rem;}
    .brand-desc{font-size:.85rem;color:var(--text-muted);margin-bottom:1.25rem;}
    .metrics{display:flex;gap:.75rem;flex-wrap:wrap;}
    .metric-box{flex:1 1 100px;text-align:center;background:var(--bg-muted);padding:.7rem;border-radius:8px;border:1px solid var(--border);}    
    .metric-val{font-weight:700;color:var(--accent);} .metric-label{font-size:.7rem;color:var(--text-muted);text-transform:uppercase;letter-spacing:.4px;}
    .spark{width:100%;height:32px;margin-top:.35rem;}
    /* views & columns */
    .view{display:none;} .view.active{display:block;}
    .pipeline-wrap{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:2rem;gap:1rem;flex-wrap:wrap;}
    .add-btn{padding:.45rem .9rem;background:var(--accent);color:#fff;border:none;border-radius:8px;font-size:.8rem;font-weight:600;cursor:pointer;white-space:nowrap;display:flex;align-items:center;gap:.3rem;}
    .add-btn svg{width:18px;height:18px;}
    .pipeline{display:flex;gap:1rem;overflow-x:auto;}
    .column{min-width:220px;background:var(--bg-muted);border:1px solid var(--border);border-radius:9px;padding:1rem;flex:1 0 220px;}
    .column-header{font-weight:600;margin-bottom:.75rem;font-size:.9rem;display:flex;justify-content:space-between;align-items:center;}
    .column-count{background:var(--accent);color:#fff;font-size:.65rem;padding:.15rem .45rem;border-radius:6px;}
    .item{background:var(--bg);border:1px solid var(--border);border-radius:7px;padding:.5rem;font-size:.82rem;margin-bottom:.5rem;cursor:grab;transition:transform .2s;display:flex;justify-content:space-between;align-items:center;gap:.5rem;}
    .item:hover{transform:translateY(-2px);} .ghost{opacity:.3;border-style:dashed;}
    .item:focus{outline:2px solid var(--accent);} /* keyboard */
    .item-date{font-size:.7rem;color:var(--text-muted);}    
    /* brand metrics grid */
    .brand-metrics{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:1rem;margin-bottom:2rem;}
    .brand-mbox{background:var(--bg-muted);border:1px solid var(--border);border-radius:12px;padding:1.4rem;text-align:center;box-shadow:var(--card-shadow);}    
    .brand-mval{font-family:'Playfair Display',serif;font-size:1.8rem;font-weight:700;color:var(--accent);} .brand-mlabel{margin-top:.25rem;font-size:.85rem;color:var(--text-muted);}    
    /* modal */
    .modal{position:fixed;inset:0;background:rgba(0,0,0,.45);display:flex;justify-content:center;align-items:center;z-index:1000;}
    .modal-card{background:var(--bg);padding:1.5rem 2rem;border-radius:12px;width:90%;max-width:380px;box-shadow:0 8px 20px rgba(0,0,0,.15);}    
    .modal-card h3{font-size:1.15rem;font-weight:600;margin-bottom:1rem;}
    .modal-card label{font-size:.8rem;font-weight:600;color:var(--text-muted);display:block;margin-top:.75rem;margin-bottom:.25rem;}
    .modal-card input{width:100%;padding:.55rem .6rem;border:1px solid var(--border);border-radius:8px;font-size:.85rem;}
    .modal-actions{display:flex;justify-content:flex-end;gap:.5rem;margin-top:1.2rem;}
    .btn{padding:.45rem 1rem;border:none;border-radius:8px;font-size:.8rem;font-weight:600;cursor:pointer;}
    .btn.primary{background:var(--accent);color:#fff;}
    .btn.secondary{background:var(--bg-muted);}    
  </style>
</head>
<body>
  <div class="container">
    <h1>Empire Dashboard</h1>
    <div id="nav" class="nav"></div>
    <div id="empireTotals" class="totals"></div>
    <div id="overviewGrid" class="grid"></div>
    <div id="views"></div>
  </div>
<!-- JS after content to avoid blocking paint -->
<script>
(function(){
'use strict';
var REFRESH_MS=15*60*1000;
var STAGES_EDITORIAL=['ideas','inProgress','ready','published'];
var STAGES_EVENT=['planning','upcoming','marketing','completed'];
var EVENT_BRANDS=['bwitw','indigo'];
var metrics={},goals={},pipelines={};
function fmt(n){return n>=1000?Intl.NumberFormat('en',{notation:'compact'}).format(n):n;}
function qs(sel){return document.querySelector(sel);} // safe helper
function seed(){['knf','fh','mtih','sss','tok','bwitw','indigo'].forEach(function(id){var st=EVENT_BRANDS.indexOf(id)>-1?STAGES_EVENT:STAGES_EDITORIAL;pipelines[id]={};st.forEach(function(s){pipelines[id][s]=[];});});
  pipelines.knf.ideas=[{title:'Award season analysis'},{title:'TikTok trends'}];
  pipelines.bwitw.planning=[{title:'Summer Rooftop Mixer',date:'2025-07-15'}];
}
var demoMetrics={knf:{name:'Kimberly Nicole Foster',status:'active',desc:'Personal brand & cultural criticism',pipeline:24,reach:125000,revenue:15000,engagement:8.5},fh:{name:'For Harriet',status:'active',desc:'Black feminist publication',pipeline:32,reach:250000,revenue:22000,engagement:12},mtih:{name:'Making Things is Hard',status:'active',desc:'Tech & business for creatives',pipeline:18,reach:45000,revenue:8000,engagement:15},sss:{name:'The Shallow Side',status:'launching',desc:'Fashion & beauty commentary',pipeline:12,reach:500,revenue:0,engagement:0},tok:{name:'Taste of Kimberly',status:'planning',desc:'Personal style newsletter',pipeline:15,reach:0,revenue:0,engagement:0},bwitw:{name:'Black Women in the Wild',status:'active',desc:'Community events & connections',events:6,community:250,groups:12},indigo:{name:'The Indigo Hour',status:'planning',desc:'Intellectual salon series',concepts:5,capacity:25}};
var demoGoals={knf:{reach:150000,revenue:20000},fh:{reach:300000,revenue:25000}};
var brandOrder=['knf','fh','mtih','sss','tok','bwitw','indigo'];
/* DOM refs */
var elNav,elTotals,elGrid,elViews;
/* NAV */
function makeNav(){[ 'overview' ].concat(brandOrder).forEach(function(id){var b=document.createElement('button');b.className='nav-btn';b.dataset.view=id;b.textContent=id==='overview'?'Overview':metrics[id].name;b.addEventListener('click',function(){showView(id);});elNav.appendChild(b);});}
function navActive(id){[].forEach.call(elNav.querySelectorAll('.nav-btn'),function(b){b.classList.toggle('active',b.dataset.view===id);});}
/* TOTALS */
function buildTotals(){var totP=0,totR=0,totRev=0;brandOrder.forEach(function(id){var m=metrics[id];totP+=(m.pipeline||0);totR+=(m.reach||0);totRev+=(m.revenue||0);});
  elTotals.innerHTML='';
  var add=function(v,l){var box=document.createElement('div');box.className='total-box';box.innerHTML='<div class="total-val">'+v+'</div><div class="total-label">'+l+'</div>';elTotals.appendChild(box);}  ;
  add(fmt(totP),'PIPELINE');add(fmt(totR),'REACH');add('$'+fmt(totRev),'REVENUE');
}
/* OVERVIEW */
function metric(val,label){return '<div class="metric-box"><div class="metric-val">'+val+'</div><div class="metric-label">'+label+'</div></div>';}
function buildOverview(){elGrid.innerHTML='';brandOrder.forEach(function(id){var m=metrics[id];var c=document.createElement('div');c.className='card';c.dataset.brand=id;
    c.innerHTML='<div class="badge '+m.status+'">'+m.status+'</div><div class="brand-title">'+m.name+'</div><div class="brand-desc">'+(m.desc||'')+'</div><div class="metrics"></div>';
    var met=c.querySelector('.metrics');if(m.pipeline)met.insertAdjacentHTML('beforeend',metric(fmt(m.pipeline),'pipeline'));if(m.reach)met.insertAdjacentHTML('beforeend',metric(fmt(m.reach),'reach'));if(m.engagement)met.insertAdjacentHTML('beforeend',metric(m.engagement+'%','engagement'));if(m.revenue)met.insertAdjacentHTML('beforeend',metric('$'+fmt(m.revenue),'revenue'));if(m.events)met.insertAdjacentHTML('beforeend',metric(m.events,'events'));c.addEventListener('click',function(){showView(id);});elGrid.appendChild(c);});}
/* VIEWS & PIPELINES (simplified preview build) */
function buildViews(){elViews.innerHTML='';brandOrder.forEach(function(id){var m=metrics[id];var view=document.createElement('div');view.className='view';view.id='view-'+id;view.dataset.brand=id;
    view.innerHTML='<h2>'+m.name+'</h2><p style="color:var(--text-muted);margin-bottom:1.5rem;">'+(m.desc||'')+'</p><p style="font-size:.9rem;color:#f43f5e;">Detailed pipeline hidden in preview‑safe build.</p>';
    elViews.appendChild(view);});}
function showView(id){navActive(id);if(id==='overview'){elGrid.style.display='grid';elTotals.style.display='flex';[].forEach.call(elViews.children,function(v){v.classList.remove('active');});return;}
  elGrid.style.display='none';elTotals.style.display='none';[].forEach.call(elViews.children,function(v){v.classList.toggle('active',v.id==='view-'+id);});}
/* DATA LOADERS */
function loadJSON(url,cb){var xhr=new XMLHttpRequest();xhr.open('GET',url,true);xhr.onreadystatechange=function(){if(xhr.readyState===4){if(xhr.status===200){try{cb(JSON.parse(xhr.responseText));}catch(e){cb(null);} }else cb(null);} };xhr.send();}
function refresh(){loadJSON('data/metrics.json',function(data){if(data){metrics=data;buildTotals();buildOverview();}});}
/* INIT */
function init(){elNav=qs('#nav');elTotals=qs('#empireTotals');elGrid=qs('#overviewGrid');elViews=qs('#views');
  seed();metrics=demoMetrics;goals=demoGoals;makeNav();buildTotals();buildOverview();buildViews();showView('overview');setInterval(refresh,REFRESH_MS);}
if(document.readyState!=='loading')init();else document.addEventListener('DOMContentLoaded',init);
})();
</script>
</body>
</html>
